<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/styles/global.css" />
    <title>Staff</title>
  </head>
  <body>

    <!-- Navbar -->
    <ul>
      <li><a class="active" href="/">Home</a></li>
      <li><a class="" href="/staff/add">Add New Client</a></li>
      <li><a class="" href="/staff">My Clients</a></li>
    </ul>
    <!-- Navbar end -->

    <h1 class="text-center">My Clients</h1>

    <table class="w-full">
      <thead>
        <tr>
          <th>ID</th>
          <th>Name</th>
          <th>DOB</th>
          <th>Phone</th>
          <th>Action</th>
        </tr>
      </thead>
      <tfoot></tfoot>
      <tbody id="tbody">
        <!-- Content -->
        <!-- End content -->
      </tbody>
    </table>

    <script>
      const tbody = document.getElementById("tbody");
      const addClientInput = document.getElementById("addClientInput");
      const nameInput = document.getElementById("nameInput");
      const dobInput = document.getElementById("dobInput");
      const phoneInput = document.getElementById("phoneInput");

      const editInput = `<button class="button">Edit</button>`;

      // ============================= HTTP request helpers =============================
      const getAllClients = async () => {
        const res = await fetch(`http://${window.location.host}/api/clientlist/staff/1`);
        return res.json();
      };

      // ============================= GUI handlers =============================
      const generateTable = async () => {
        const clients = await getAllClients();

        clients.forEach((client) => {
          addSingleRow(client);
        });
      };

      const addSingleRow = async (client) => {
        let newRow = document.createElement("tr");
        newRow.id = client.clientID;
        Object.values(client).forEach((val) => {
          let field = document.createElement("td");
          field.innerText = val;
          newRow.appendChild(field);
        });
        let action = document.createElement("td");
        action.appendChild(getDeleteButton(client.clientID));

        newRow.appendChild(action);
        tbody.appendChild(newRow);
      };

      // ============================= Button Handlers =============================

      // ============================= Start Up =============================
      generateTable();
    </script>
  </body>
</html>
